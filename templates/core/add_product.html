<!-- templates/core/add_product.html -->
{% extends 'core/base.html' %}
{% load i18n static %}

{% block title %}Add Your Produce - AgriConnect{% endblock %}
{% block content %}
<div class="container">
    <h1 class="text-center">{% trans "Add Your Produce" %}</h1>
    <form id="product-form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <div id="image-preview" class="mt-3 mb-3">
            <p>{% trans "Image Preview" %}</p>
        </div>
        <button type="submit" class="btn btn-primary">{% trans "Add Product" %}</button>
    </form>

    <!-- preview the uploaded image -->
    <script>
    document.getElementById('id_image').addEventListener('change', function(event) {
        const file = event.target.files[0];
        const previewContainer = document.getElementById('image-preview');
        
        // Clear previous preview
        previewContainer.innerHTML = '<p>{% trans "Image Preview" %}</p>';
        
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                const imgPreview = document.createElement('img');
                imgPreview.src = e.target.result;
                imgPreview.style.maxWidth = '300px';
                imgPreview.style.maxHeight = '300px';
                imgPreview.className = 'img-fluid rounded';
                previewContainer.appendChild(imgPreview);
            };
            reader.readAsDataURL(file);
        }
    });
    </script>
</div>
{% endblock %}
